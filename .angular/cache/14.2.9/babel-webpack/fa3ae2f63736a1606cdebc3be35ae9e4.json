{"ast":null,"code":"import { MatPaginator } from '@angular/material/paginator';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { UsersComponent } from '../dashboard/users/users.component';\nimport { ReportsComponent } from '../dashboard/reports/reports.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/snack-bar\";\nimport * as i2 from \"src/app/services/signPost/sign-post.service\";\nimport * as i3 from \"src/app/services/products/products.service\";\nimport * as i4 from \"src/app/services/users/users.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"src/app/services/reports/reports.service\";\nconst _c0 = [\"chartRef\"];\n\nfunction DashboardComponent_ng_container_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nexport let DashboardComponent = /*#__PURE__*/(() => {\n  class DashboardComponent {\n    constructor(_snackBar, signPostSrvc, productSrvc, userSrvc, router, reportServ) {\n      this._snackBar = _snackBar;\n      this.signPostSrvc = signPostSrvc;\n      this.productSrvc = productSrvc;\n      this.userSrvc = userSrvc;\n      this.router = router;\n      this.reportServ = reportServ;\n      this.displayedColumns = ['productCode', 'status', 'price', 'createdAt', 'updatedAt', 'action'];\n      this.stats = {\n        total: 0,\n        sold: 0,\n        available: 0,\n        revenue: 0\n      };\n      this.hotspotsPrivate = [// {\n        //     propertyId: \"ced3bc57-a4bc-41e6-9b48-782c249fe044\",\n        //     \"propertyName\": \"Riviera Varsity Lodge\",\n        //     \"geoLocation\": {\n        //         \"latitude\": -26.58495,\n        //         \"longitude\": 28.02231\n        //     },\n        //     \"weight\": 0.9\n        // },\n        // {\n        //     \"propertyId\": \"95f02764-c9d7-4966-a3e0-c1456a69e482\",\n        //     \"propertyName\": \"Miami Building\",\n        //     \"geoLocation\": {\n        //         \"latitude\": 0,\n        //         \"longitude\": 0\n        //     },\n        //     \"weight\": 0\n        // },\n        // {\n        //     \"propertyId\": \"7f763d29-57d5-4442-ac3e-0f474d6445d2\",\n        //     \"propertyName\": \"Nomndeni Lodge 1\",\n        //     \"geoLocation\": {\n        //         \"latitude\": -25.498156,\n        //         \"longitude\": 30.9899791\n        //     },\n        //     \"weight\": 0.3\n        // },\n        // {\n        //     \"propertyId\": \"697c0402-8c06-4694-bc4c-2b8d5efd02fc\",\n        //     \"propertyName\": \"Old Hebron College of Education\",\n        //     \"geoLocation\": {\n        //         \"latitude\": -25.5126819,\n        //         \"longitude\": 28.0552803\n        //     },\n        //     \"weight\": 0\n        // },\n        // {\n        //     \"propertyId\": \"7bce9374-9b6c-48a5-900c-4583c77f02bb\",\n        //     \"propertyName\": \"Respublica West City\",\n        //     \"geoLocation\": {\n        //         \"latitude\": -25.7556031,\n        //         \"longitude\": 28.11672\n        //     },\n        //     \"weight\": 0\n        // },\n        // {\n        //     \"propertyId\": \"35389abf-5007-4bf4-8522-84497a161f84\",\n        //     \"propertyName\": \"Tshwane Varsity Lodge 2\",\n        //     \"geoLocation\": {\n        //         \"latitude\": -25.7414709,\n        //         \"longitude\": 28.15231\n        //     },\n        //     \"weight\": 0\n        // },\n        // {\n        //     \"propertyId\": \"bc459efb-f4bb-4bb6-a181-90774d3ca162\",\n        //     \"propertyName\": \"Everest Towers\",\n        //     \"geoLocation\": {\n        //         \"latitude\": 0,\n        //         \"longitude\": 0\n        //     },\n        //     \"weight\": 0.3\n        // },\n        // {\n        //     \"propertyId\": \"5f84f406-3e2e-46a5-9022-4ab41fd48ee6\",\n        //     \"propertyName\": \"Muzinda\",\n        //     \"geoLocation\": {\n        //         \"latitude\": -25.7599894,\n        //         \"longitude\": 28.1377809\n        //     },\n        //     \"weight\": 0\n        // },\n        // {\n        //     \"propertyId\": \"80380203-18c6-4c71-8b9f-13cc5d00644f\",\n        //     \"propertyName\": \"Arebeng 2\",\n        //     \"geoLocation\": {\n        //         \"latitude\": 0,\n        //         \"longitude\": 0\n        //     },\n        //     \"weight\": 0.3\n        // }\n      ];\n      this.fileExtension = null;\n      this.loading = true;\n      this.userSrvc.getActiveUser().subscribe(user => {\n        //console.log(user);\n        if (!user || user.role != 'ADMIN') {\n          this.router.navigate(['/']);\n        }\n\n        this.user = user;\n      });\n    }\n\n    ngOnInit() {\n      this.productSrvc.getProducts().then(resp => {\n        // tslint:disable-next-line: comment-format\n        //console.log(resp);\n        if (resp.products.length > 0) {\n          // tslint:disable-next-line: prefer-const\n          let products = resp.products;\n          console.table(products);\n          this.statsGenerator(products);\n          this.dataSource = new MatTableDataSource(products);\n          this.dataSource.paginator = this.paginator;\n          this.loading = false;\n        }\n      }).then(error => {// tslint:disable-next-line: comment-format\n        //console.log(error);\n      });\n      this.getUsers();\n      this.getReport();\n    }\n\n    getReport() {\n      this.loading = true;\n      this.reportServ.getReports().then(resp => {\n        this.reportCount = resp.count;\n      }).catch(error => {\n        this.loading = false;\n      });\n    }\n\n    getUsers() {\n      this.loading = true;\n      this.userSrvc.getUsers().then(resp => {\n        this.userCount = resp.count;\n        console.log(this.userCount); // this.users = resp.users;\n      }).catch(error => {\n        this.loading = false;\n      });\n    }\n\n    applyFilter(event) {\n      const filterValue = event.value;\n      this.dataSource.filter = filterValue.trim().toLowerCase();\n    }\n\n    statsGenerator(vouchers) {\n      this.stats = {\n        total: 0,\n        sold: 0,\n        available: 0,\n        revenue: 0\n      };\n\n      for (let index = 0; index < vouchers.length; index++) {\n        const element = vouchers[index];\n\n        if (element.status === 'DISPENSED') {\n          this.stats.sold++;\n        }\n      }\n\n      this.stats.total = vouchers.length;\n      this.stats.available = this.stats.total - this.stats.sold;\n      this.stats.revenue = this.stats.sold * this.price;\n    }\n\n    onFileSelected(event) {\n      let selectedfile = event.target.files[0];\n      let filename = selectedfile.name;\n      filename = filename.split('.');\n      this.selectedfile = selectedfile;\n      let fileExtension = filename[filename.length - 1];\n      this.fileExtension = fileExtension; // tslint:disable-next-line: comment-format\n      ////console.log(this.fileExtension);\n\n      if (fileExtension != 'xlsx' && fileExtension != 'xlsb') {\n        this.openSnackBar('Only excel files are supported', 'Close');\n        return;\n      }\n\n      this.loading = true;\n      this.getUrl(selectedfile, fileExtension);\n    }\n\n    getUrl(selectedfile, fileExtension) {\n      //this.loader = true;\n      let dataObject;\n      let formData = new FormData();\n      this.signPostSrvc.getpresignedurls(fileExtension).then(res => {\n        dataObject = res;\n        Object.keys(dataObject.presignedPost.fields).forEach(key => {\n          formData.append(key, dataObject.presignedPost.fields[key]);\n        });\n        formData.append('file', selectedfile);\n        this.uploadFile(dataObject.presignedPost.url, formData);\n      });\n    }\n\n    uploadFile(url, formData) {\n      this.signPostSrvc.uploadFile(url, formData).then(resp => {\n        // tslint:disable-next-line:comment-format\n        //this.loader = false;\n        // tslint:disable-next-line:comment-format\n        //console.log(resp);\n        // this.getVouchers();\n        this.openSnackBar('Funding Records Uploaded Successful', 'Close');\n      }).catch(error => {\n        // tslint:disable-next-line: comment-format\n        //this.loader = false;\n        // tslint:disable-next-line: comment-format\n        //console.log(error);\n        this.loading = true;\n        this.openSnackBar('Something went wrong, please contact support', 'Close');\n      });\n    }\n\n    openSnackBar(message, action) {\n      this._snackBar.open(message, action, {\n        duration: 5500,\n        verticalPosition: 'top',\n        horizontalPosition: 'center'\n      });\n    }\n\n    deleteProduct(id) {\n      this.productSrvc.getDeleteProduct(id).then(resp => {\n        console.log(resp);\n      });\n    }\n\n    updateProduct(product) {\n      return this.router.navigate(['edit-product/'], {\n        state: {\n          data: product\n        }\n      }); // this.productSrvc.getUpdateProduct(id,this.product).then(resp => {\n      //   console.log(resp);\n      //  }\n      // )\n    }\n\n    createProduct() {\n      return this.router.navigate(['create-product/']); // this.productSrvc.getUpdateProduct(id,this.product).then(resp => {\n      //   console.log(resp);\n      //  }\n      // )\n    }\n\n    assignComponent(component) {\n      if (component === 'users') {\n        this.selectedComponent = UsersComponent;\n      } else if (component === 'reports') {\n        this.selectedComponent = ReportsComponent;\n      }\n    }\n\n  }\n\n  DashboardComponent.ɵfac = function DashboardComponent_Factory(t) {\n    return new (t || DashboardComponent)(i0.ɵɵdirectiveInject(i1.MatSnackBar), i0.ɵɵdirectiveInject(i2.SignPostService), i0.ɵɵdirectiveInject(i3.ProductsService), i0.ɵɵdirectiveInject(i4.UsersService), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i6.ReportsService));\n  };\n\n  DashboardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: DashboardComponent,\n    selectors: [[\"app-dashboard\"]],\n    viewQuery: function DashboardComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n        i0.ɵɵviewQuery(MatPaginator, 7);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.chartRef = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n      }\n    },\n    decls: 47,\n    vars: 7,\n    consts: [[\"id\", \"left\"], [\"id\", \"vertical-rule\"], [\"id\", \"row\"], [\"id\", \"profile\", 3, \"matMenuTriggerFor\"], [\"menu\", \"matMenu\"], [1, \"wrapper\"], [\"id\", \"heading\"], [\"id\", \"stats\"], [1, \"stat\", 3, \"click\"], [1, \"icon\"], [1, \"details\"], [4, \"ngComponentOutlet\"], [\"type\", \"file\", \"name\", \"file\", \"id\", \"file\", \"hidden\", \"\", 3, \"change\"], [\"inputfile\", \"\"]],\n    template: function DashboardComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"header\")(1, \"nav\")(2, \"div\", 0)(3, \"div\");\n        i0.ɵɵtext(4, \" MY WEB \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(5, \"div\", 1);\n        i0.ɵɵelementStart(6, \"ul\")(7, \"li\");\n        i0.ɵɵtext(8, \"Dashboard\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(9, \"div\", 2)(10, \"div\");\n        i0.ɵɵtext(11);\n        i0.ɵɵpipe(12, \"titlecase\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 3)(14, \"mat-icon\");\n        i0.ɵɵtext(15, \"account_box\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(16, \"mat-menu\", null, 4);\n        i0.ɵɵelement(18, \"app-account\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(19, \"div\", 5)(20, \"main\")(21, \"div\", 6)(22, \"h3\");\n        i0.ɵɵtext(23, \"Statistics\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(24, \"div\", 7)(25, \"div\", 8);\n        i0.ɵɵlistener(\"click\", function DashboardComponent_Template_div_click_25_listener() {\n          return ctx.assignComponent(\"users\");\n        });\n        i0.ɵɵelementStart(26, \"div\", 9)(27, \"mat-icon\");\n        i0.ɵɵtext(28, \"account_balance\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(29, \"div\", 10)(30, \"h3\");\n        i0.ɵɵtext(31, \"User\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"h4\");\n        i0.ɵɵtext(33);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(34, \"div\", 8);\n        i0.ɵɵlistener(\"click\", function DashboardComponent_Template_div_click_34_listener() {\n          return ctx.assignComponent(\"reports\");\n        });\n        i0.ɵɵelementStart(35, \"div\", 9)(36, \"mat-icon\");\n        i0.ɵɵtext(37, \"local_offer\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(38, \"div\", 10)(39, \"h3\");\n        i0.ɵɵtext(40, \"Reports\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"h4\");\n        i0.ɵɵtext(42);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(43, \"h1\");\n        i0.ɵɵtemplate(44, DashboardComponent_ng_container_44_Template, 1, 0, \"ng-container\", 11);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(45, \"input\", 12, 13);\n        i0.ɵɵlistener(\"change\", function DashboardComponent_Template_input_change_45_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(17);\n\n        i0.ɵɵadvance(11);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(12, 5, ctx.user.firstName + \" \" + ctx.user.lastName), \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"matMenuTriggerFor\", _r0);\n        i0.ɵɵadvance(20);\n        i0.ɵɵtextInterpolate(ctx.userCount);\n        i0.ɵɵadvance(9);\n        i0.ɵɵtextInterpolate(ctx.reportCount);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngComponentOutlet\", ctx.selectedComponent);\n      }\n    },\n    styles: [\"header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:99;background:#F2F3F5}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]{width:calc(100% - 80px);height:80px;margin:auto;display:flex;flex-direction:row;align-items:center;justify-content:space-between}header[_ngcontent-%COMP%]   #left[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}header[_ngcontent-%COMP%]   #left[_ngcontent-%COMP%]   #logo[_ngcontent-%COMP%]{background:url(t-retail.svg) left center no-repeat;background-size:contain;height:80px;width:150px}header[_ngcontent-%COMP%]   #left[_ngcontent-%COMP%]   #vertical-rule[_ngcontent-%COMP%]{border-left:1px solid #8D99AE;height:40px;margin:0 60px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{text-decoration:none;margin:0;padding:0}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-block;margin-right:30px;font-weight:700;cursor:pointer}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-right:0}header[_ngcontent-%COMP%]   #cart[_ngcontent-%COMP%]{margin-left:40px}header[_ngcontent-%COMP%]   #cart[_ngcontent-%COMP%]   #padding[_ngcontent-%COMP%]{padding:20px}header[_ngcontent-%COMP%]   #cart[_ngcontent-%COMP%]   #quantity[_ngcontent-%COMP%]{text-align:center;height:24px;width:24px;line-height:24px;border-radius:50%;background:#2B2D42;position:absolute;margin-left:24px;margin-top:-12px;color:#fff}header[_ngcontent-%COMP%]   #right[_ngcontent-%COMP%]   #profile[_ngcontent-%COMP%]{padding:7px;height:40px;width:40px;border-radius:4px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none}header[_ngcontent-%COMP%]   #right[_ngcontent-%COMP%]   #profile[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{display:block;color:#8d99ae;font-size:40px!important}.wrapper[_ngcontent-%COMP%]{width:960px;margin:auto}.h2[_ngcontent-%COMP%]{font-weight:700;font-size:2em;margin:1.7em 0}.h3[_ngcontent-%COMP%]{font-weight:700;font-size:1.7em;margin:1.2em 0}.chart[_ngcontent-%COMP%]{position:relative}.chart[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:relative;height:400px!important;width:1080px!important}main[_ngcontent-%COMP%]{margin-top:80px;padding-top:40px}main[_ngcontent-%COMP%]   #heading[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:10px 0 20px;font-weight:700;text-transform:uppercase}main[_ngcontent-%COMP%]   #controls[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 250px;grid-gap:20px;gap:20px}main[_ngcontent-%COMP%]   #controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}main[_ngcontent-%COMP%]   #controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:3px;height:53px}main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);grid-gap:40px;gap:40px;margin-bottom:20px}main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:4px 0}main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{box-sizing:border-box;padding:20px;border-radius:10px;display:flex;flex-direction:row;align-items:center;justify-content:space-between}main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{text-align:right}main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]:nth-child(1){background-image:linear-gradient(120deg,#e0c3fc 0%,#8ec5fc 100%)}main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]:nth-child(2){background-image:linear-gradient(120deg,#84fab0 0%,#8fd3f4 100%)}main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]:nth-child(3){background-image:linear-gradient(120deg,#a1c4fd 0%,#c2e9fb 100%)}main[_ngcontent-%COMP%]   #stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]:nth-child(4){background-image:linear-gradient(to right,#4facfe 0%,#00f2fe 100%)}table[_ngcontent-%COMP%]{width:100%;background:#F2F3F5}mat-paginator[_ngcontent-%COMP%]{background:#F2F3F5}\"]\n  });\n  return DashboardComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}